var ngPrint=angular.module("ngPrint",[]);
ngPrint.factory("pdfPrinter",["$q","$timeout",function(t){"use strict";var e=function(){var e=this,r=function(t,e){if(e=parseInt(e,10)||0,!e)return t;var r=document.createElement("canvas"),n=r.getContext("2d");return r.height=t.height-e,r.width=t.width,Pixastic.process(t,"crop",{rect:{left:0,top:e,width:t.width,height:t.height-e}},function(t){n.drawImage(t,0,0,t.width,t.height,0,0,t.width,t.height)}),r},n=function(t,e,n,i){for(var a=new jsPDF(e,n,i),h=a.internal,o=h.pageSize,d=h.scaleFactor,c=o.width,g=o.height,u=0,f=t.height,s=t.width/(c*d),w=0;f>u&&15>w;){var m=r(t,u),v=Math.random().toString(35);a.addImage(m,0,0,c,0,"png",v,"SLOW"),u+=g*d*s,f>u&&a.addPage(),w+=1}return a};e.generatePdfFromElement=function(e,r,i,a){var h=t.defer();return html2canvas(e,{onrendered:function(t){var e=n(t,r,i,a);h.resolve(e)}}),h.promise}},r=new e;return r}]);
ngPrint.directive("ngPrintButton",["$window","pdfPrinter",function(t,n){"use strict";return{restrict:"AC",require:"^ngPrintable",scope:{printWholePage:"&?",saveAs:"@?"},link:function(e,i,r,a){var o=function(t){return{orientation:t[0].attributes.orientation?t[0].attributes.orientation.value:"p",unit:t[0].attributes.unit?t[0].attributes.unit.value:"pt",format:t[0].attributes.format?t[0].attributes.format.value:"a4"}};e.print=function(){var i;if(e.printWholePage()?i=t.document.body:a&&(i=a.getElement()),!i)throw new SyntaxError("No template element provided. Try using ngPrintable directive.");var r=o(i),u=n.generatePdfFromElement(i,r.orientation,r.unit,r.format);u.then(function(t){e.saveAs?t.save(e.saveAs):t.output("dataurlnewwindow"),t=null})},i.on("click",function(){e.print()})}}}]);
ngPrint.directive("ngPrintable",[function(){"use strict";return{restrict:"A",scope:{orientation:"@?",unit:"@?",format:"@?"},link:function(t,n){t.element=n},controller:["$scope",function(t){this.getElement=function(){return t.element}}]}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5nUHJpbnQtbW9kdWxlLmpzIiwicGRmUHJpbnRlci1zZXJ2aWNlLmpzIiwiY29tcG9uZW50cy9kaXJlY3RpdmVzL25nUHJpbnRCdXR0b24vbmdQcmludEJ1dHRvbi1kaXJlY3RpdmUuanMiLCJjb21wb25lbnRzL2RpcmVjdGl2ZXMvbmdQcmludGFibGUvbmdQcmludGFibGUtZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbIm5nUHJpbnQiLCJhbmd1bGFyIiwibW9kdWxlIiwiZmFjdG9yeSIsIiRxIiwiUGRmUHJpbnRlciIsInNlbGYiLCJ0aGlzIiwiY2FudmFzU2hpZnRJbWFnZSIsIm9sZENhbnZhcyIsInNoaWZ0QW10IiwicGFyc2VJbnQiLCJuZXdDYW52YXMiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjdHgiLCJnZXRDb250ZXh0IiwiaGVpZ2h0Iiwid2lkdGgiLCJQaXhhc3RpYyIsInByb2Nlc3MiLCJyZWN0IiwibGVmdCIsInRvcCIsImRyYXdJbWFnZSIsImdlbmVyYXRlUGRmRnJvbUNhbnZhcyIsImNhbnZhcyIsIm9yaWVudGF0aW9uIiwidW5pdCIsImZvcm1hdCIsInBkZiIsImpzUERGIiwicGRmSW50ZXJuYWxzIiwiaW50ZXJuYWwiLCJwZGZQYWdlU2l6ZSIsInBhZ2VTaXplIiwicGRmU2NhbGVGYWN0b3IiLCJzY2FsZUZhY3RvciIsInBkZlBhZ2VXaWR0aCIsInBkZlBhZ2VIZWlnaHQiLCJ0b3RhbFBkZkhlaWdodCIsImh0bWxQYWdlSGVpZ2h0IiwiaHRtbFNjYWxlRmFjdG9yIiwic2FmZXR5TmV0IiwiYWxpYXMiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJhZGRJbWFnZSIsImFkZFBhZ2UiLCJnZW5lcmF0ZVBkZkZyb21FbGVtZW50IiwiZWxlbWVudCIsImRlZmVycmVkIiwiZGVmZXIiLCJodG1sMmNhbnZhcyIsIm9ucmVuZGVyZWQiLCJyZXNvbHZlIiwicHJvbWlzZSIsImluc3QiLCJkaXJlY3RpdmUiLCIkd2luZG93IiwicGRmUHJpbnRlciIsInJlc3RyaWN0IiwicmVxdWlyZSIsInNjb3BlIiwicHJpbnRXaG9sZVBhZ2UiLCJzYXZlQXMiLCJsaW5rIiwiJHNjb3BlIiwiYXR0ciIsIm5nUHJpbnRhYmxlQ29udHJvbGxlciIsImdldENvbmZpZ0F0dHJpYnV0ZXMiLCJhdHRyaWJ1dGVzIiwidmFsdWUiLCJwcmludCIsImJvZHkiLCJnZXRFbGVtZW50IiwiU3ludGF4RXJyb3IiLCJjb25maWciLCJ0aGVuIiwic2F2ZSIsIm91dHB1dCIsIm9uIiwiY29udHJvbGxlciJdLCJtYXBwaW5ncyI6IkFBRUEsR0FBSUEsU0FBVUMsUUFBUUMsT0FBTztBQ0E3QkYsUUFBUUcsUUFBUSxjQUFlLEtBQU0sV0FBWSxTQUFVQyxHQUN2RCxZQUVILElBQUlDLEdBQWEsV0FDaEIsR0FBSUMsR0FBT0MsS0FDREMsRUFBbUIsU0FBVUMsRUFBV0MsR0FFcEMsR0FEQUEsRUFBV0MsU0FBU0QsRUFBVSxLQUFPLEdBQ2hDQSxFQUFZLE1BQU9ELEVBRXhCLElBQUlHLEdBQVlDLFNBQVNDLGNBQWMsVUFDbkNDLEVBQU1ILEVBQVVJLFdBQVcsS0FTL0IsT0FQQUosR0FBVUssT0FBU1IsRUFBVVEsT0FBU1AsRUFDdENFLEVBQVVNLE1BQVFULEVBQVVTLE1BRTVCQyxTQUFTQyxRQUFRWCxFQUFXLFFBQVNZLE1BQU9DLEtBQU0sRUFBR0MsSUFBS2IsRUFBVVEsTUFBT1QsRUFBVVMsTUFBT0QsT0FBU1IsRUFBVVEsT0FBU1AsSUFBYSxTQUFVRSxHQUMzSUcsRUFBSVMsVUFBVVosRUFBVyxFQUFHLEVBQUdBLEVBQVVNLE1BQU9OLEVBQVVLLE9BQVEsRUFBRyxFQUFHTCxFQUFVTSxNQUFPTixFQUFVSyxVQUdoR0wsR0FZWGEsRUFBd0IsU0FBVUMsRUFBUUMsRUFBYUMsRUFBTUMsR0FZekQsSUFYQSxHQUFJQyxHQUFNLEdBQUlDLE9BQU1KLEVBQWFDLEVBQU1DLEdBQ25DRyxFQUFlRixFQUFJRyxTQUNuQkMsRUFBY0YsRUFBYUcsU0FDM0JDLEVBQWlCSixFQUFhSyxZQUM5QkMsRUFBZUosRUFBWWhCLE1BQzNCcUIsRUFBZ0JMLEVBQVlqQixPQUM1QnVCLEVBQWlCLEVBQ2pCQyxFQUFpQmYsRUFBT1QsT0FDeEJ5QixFQUFrQmhCLEVBQU9SLE9BQVNvQixFQUFlRixHQUNqRE8sRUFBWSxFQUVRRixFQUFqQkQsR0FBK0MsR0FBWkcsR0FBZ0IsQ0FDdEQsR0FBSS9CLEdBQVlKLEVBQWlCa0IsRUFBUWMsR0FDckNJLEVBQVFDLEtBQUtDLFNBQVNDLFNBQVMsR0FFbkNqQixHQUFJa0IsU0FBU3BDLEVBQVcsRUFBRyxFQUFHMEIsRUFBYyxFQUFHLE1BQU9NLEVBQU8sUUFFN0RKLEdBQW1CRCxFQUFnQkgsRUFBaUJNLEVBRS9CRCxFQUFqQkQsR0FDQVYsRUFBSW1CLFVBRVJOLEdBQWEsRUFHakIsTUFBT2IsR0FHbEJ4QixHQUFLNEMsdUJBQXlCLFNBQVVDLEVBQVN4QixFQUFhQyxFQUFNQyxHQUM3RCxHQUFJdUIsR0FBV2hELEVBQUdpRCxPQVNsQixPQVBBQyxhQUFZSCxHQUNSSSxXQUFZLFNBQVU3QixHQUNsQixHQUFJSSxHQUFNTCxFQUFzQkMsRUFBUUMsRUFBYUMsRUFBTUMsRUFDM0R1QixHQUFTSSxRQUFRMUIsTUFJbEJzQixFQUFTSyxVQUlwQkMsRUFBTyxHQUFJckQsRUFFbEIsT0FBT3FEO0FDM0VSMUQsUUFBUTJELFVBQVUsaUJBQWtCLFVBQVcsYUFBYyxTQUFVQyxFQUFTQyxHQUM1RSxZQUVILFFBQ0NDLFNBQVUsS0FDVkMsUUFBUyxlQUNUQyxPQUNDQyxlQUFnQixLQUNQQyxPQUFRLE1BRWxCQyxLQUFNLFNBQVVDLEVBQVFqQixFQUFTa0IsRUFBTUMsR0FDdEMsR0FBSUMsR0FBc0IsU0FBVXBCLEdBQ25DLE9BQ0N4QixZQUFhd0IsRUFBUSxHQUFHcUIsV0FBd0IsWUFBSXJCLEVBQVEsR0FBR3FCLFdBQXdCLFlBQUVDLE1BQVEsSUFDakc3QyxLQUFNdUIsRUFBUSxHQUFHcUIsV0FBaUIsS0FBSXJCLEVBQVEsR0FBR3FCLFdBQWlCLEtBQUVDLE1BQVEsS0FDNUU1QyxPQUFRc0IsRUFBUSxHQUFHcUIsV0FBbUIsT0FBSXJCLEVBQVEsR0FBR3FCLFdBQW1CLE9BQUVDLE1BQVEsTUFJcEZMLEdBQU9NLE1BQVEsV0FDZCxHQUFJdkIsRUFRSixJQU5JaUIsRUFBT0gsaUJBQ1ZkLEVBQVVTLEVBQVEvQyxTQUFTOEQsS0FDakJMLElBQ1ZuQixFQUFVbUIsRUFBc0JNLGVBRzdCekIsRUFjSCxLQUFNLElBQUkwQixhQUFZLGlFQWJ0QixJQUFJQyxHQUFTUCxFQUFvQnBCLEdBQzdCTSxFQUFVSSxFQUFXWCx1QkFBdUJDLEVBQVMyQixFQUFPbkQsWUFBYW1ELEVBQU9sRCxLQUFNa0QsRUFBT2pELE9BRWxGNEIsR0FBUXNCLEtBQUssU0FBVWpELEdBQ2hCc0MsRUFBT0YsT0FDTnBDLEVBQUlrRCxLQUFLWixFQUFPRixRQUVoQnBDLEVBQUltRCxPQUFPLG9CQUdmbkQsRUFBTSxRQU8zQnFCLEVBQVErQixHQUFHLFFBQVMsV0FDUGQsRUFBT007QUNoRHZCMUUsUUFBUTJELFVBQVUsZUFBZ0IsV0FDOUIsWUFFSCxRQUNDRyxTQUFVLElBQ0pFLE9BQ0lyQyxZQUFhLEtBQ2JDLEtBQU0sS0FDTkMsT0FBUSxNQUVsQnNDLEtBQU0sU0FBVUMsRUFBUWpCLEdBQ3ZCaUIsRUFBT2pCLFFBQVVBLEdBRVpnQyxZQUFhLFNBQVUsU0FBVWYsR0FDN0I3RCxLQUFLcUUsV0FBYSxXQUNkLE1BQU9SLEdBQU9qQiIsImZpbGUiOiJuZ1ByaW50Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qZ2xvYmFsIGFuZ3VsYXIgKi9cclxuXHJcbnZhciBuZ1ByaW50ID0gYW5ndWxhci5tb2R1bGUoJ25nUHJpbnQnLCBbXSk7IiwiLypnbG9iYWwgbmdQcmludCwgUGl4YXN0aWMsIGpzUERGLCBodG1sMmNhbnZhcyAqL1xyXG5cclxubmdQcmludC5mYWN0b3J5KCdwZGZQcmludGVyJywgWyckcScsICckdGltZW91dCcsIGZ1bmN0aW9uICgkcSwgJHRpbWVvdXQpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIFxyXG5cdHZhciBQZGZQcmludGVyID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIHNlbGYgPSB0aGlzLFxyXG4gICAgICAgICAgICBjYW52YXNTaGlmdEltYWdlID0gZnVuY3Rpb24gKG9sZENhbnZhcywgc2hpZnRBbXQpIHtcclxuICAgICAgICAgICAgICAgIHNoaWZ0QW10ID0gcGFyc2VJbnQoc2hpZnRBbXQsIDEwKSB8fCAwO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFzaGlmdEFtdCkgeyByZXR1cm4gb2xkQ2FudmFzOyB9XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG5ld0NhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpLFxyXG4gICAgICAgICAgICAgICAgICAgIGN0eCA9IG5ld0NhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG5cclxuICAgICAgICAgICAgICAgIG5ld0NhbnZhcy5oZWlnaHQgPSBvbGRDYW52YXMuaGVpZ2h0IC0gc2hpZnRBbXQ7XHJcbiAgICAgICAgICAgICAgICBuZXdDYW52YXMud2lkdGggPSBvbGRDYW52YXMud2lkdGg7XHJcblxyXG4gICAgICAgICAgICAgICAgUGl4YXN0aWMucHJvY2VzcyhvbGRDYW52YXMsIFwiY3JvcFwiLCB7cmVjdDoge2xlZnQ6IDAsIHRvcDogc2hpZnRBbXQsIHdpZHRoOiBvbGRDYW52YXMud2lkdGgsIGhlaWdodDogKG9sZENhbnZhcy5oZWlnaHQgLSBzaGlmdEFtdCl9fSwgZnVuY3Rpb24gKG5ld0NhbnZhcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UobmV3Q2FudmFzLCAwLCAwLCBuZXdDYW52YXMud2lkdGgsIG5ld0NhbnZhcy5oZWlnaHQsIDAsIDAsIG5ld0NhbnZhcy53aWR0aCwgbmV3Q2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3Q2FudmFzO1xyXG4gICAgICAgICAgICB9LFxyXG5cdCAgICBcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIENyZWF0ZXMgbmV3IGpzUERGIGRvY3VtZW50IG9iamVjdCBpbnN0YW5jZS5cclxuICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICogQHBhcmFtIG9yaWVudGF0aW9uIE9uZSBvZiBcInBvcnRyYWl0XCIgb3IgXCJsYW5kc2NhcGVcIiAob3Igc2hvcnRjdXRzIFwicFwiIChEZWZhdWx0KSwgXCJsXCIpXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSB1bml0ICAgICAgICBNZWFzdXJlbWVudCB1bml0IHRvIGJlIHVzZWQgd2hlbiBjb29yZGluYXRlcyBhcmUgc3BlY2lmaWVkLlxyXG4gICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgT25lIG9mIFwicHRcIiAocG9pbnRzKSwgXCJtbVwiIChEZWZhdWx0KSwgXCJjbVwiLCBcImluXCJcclxuICAgICAgICAgICAgICogQHBhcmFtIGZvcm1hdCAgICAgIE9uZSBvZiAncGFnZUZvcm1hdHMnIGFzIHZpc2libGUgaW4ganNQREYgZG9jcywgZGVmYXVsdDogYTRcclxuICAgICAgICAgICAgICogQHJldHVybnMge2pzUERGfVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgZ2VuZXJhdGVQZGZGcm9tQ2FudmFzID0gZnVuY3Rpb24gKGNhbnZhcywgb3JpZW50YXRpb24sIHVuaXQsIGZvcm1hdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBkZiA9IG5ldyBqc1BERihvcmllbnRhdGlvbiwgdW5pdCwgZm9ybWF0KSxcclxuICAgICAgICAgICAgICAgICAgICBwZGZJbnRlcm5hbHMgPSBwZGYuaW50ZXJuYWwsXHJcbiAgICAgICAgICAgICAgICAgICAgcGRmUGFnZVNpemUgPSBwZGZJbnRlcm5hbHMucGFnZVNpemUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGRmU2NhbGVGYWN0b3IgPSBwZGZJbnRlcm5hbHMuc2NhbGVGYWN0b3IsXHJcbiAgICAgICAgICAgICAgICAgICAgcGRmUGFnZVdpZHRoID0gcGRmUGFnZVNpemUud2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgcGRmUGFnZUhlaWdodCA9IHBkZlBhZ2VTaXplLmhlaWdodCxcclxuICAgICAgICAgICAgICAgICAgICB0b3RhbFBkZkhlaWdodCA9IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgaHRtbFBhZ2VIZWlnaHQgPSBjYW52YXMuaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgIGh0bWxTY2FsZUZhY3RvciA9IGNhbnZhcy53aWR0aCAvIChwZGZQYWdlV2lkdGggKiBwZGZTY2FsZUZhY3RvciksXHJcbiAgICAgICAgICAgICAgICAgICAgc2FmZXR5TmV0ID0gMDtcclxuXHJcbiAgICAgICAgICAgICAgICB3aGlsZSAodG90YWxQZGZIZWlnaHQgPCBodG1sUGFnZUhlaWdodCAmJiBzYWZldHlOZXQgPCAxNSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdDYW52YXMgPSBjYW52YXNTaGlmdEltYWdlKGNhbnZhcywgdG90YWxQZGZIZWlnaHQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGlhcyA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzUpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHBkZi5hZGRJbWFnZShuZXdDYW52YXMsIDAsIDAsIHBkZlBhZ2VXaWR0aCwgMCwgJ3BuZycsIGFsaWFzLCAnU0xPVycpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0b3RhbFBkZkhlaWdodCArPSAocGRmUGFnZUhlaWdodCAqIHBkZlNjYWxlRmFjdG9yICogaHRtbFNjYWxlRmFjdG9yKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsUGRmSGVpZ2h0IDwgaHRtbFBhZ2VIZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGRmLmFkZFBhZ2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc2FmZXR5TmV0ICs9IDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBkZjtcclxuICAgICAgICAgICAgfTtcclxuXHJcblx0ICAgIHNlbGYuZ2VuZXJhdGVQZGZGcm9tRWxlbWVudCA9IGZ1bmN0aW9uIChlbGVtZW50LCBvcmllbnRhdGlvbiwgdW5pdCwgZm9ybWF0KSB7XHJcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBodG1sMmNhbnZhcyhlbGVtZW50LCB7XHJcbiAgICAgICAgICAgICAgICBvbnJlbmRlcmVkOiBmdW5jdGlvbiAoY2FudmFzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBkZiA9IGdlbmVyYXRlUGRmRnJvbUNhbnZhcyhjYW52YXMsIG9yaWVudGF0aW9uLCB1bml0LCBmb3JtYXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocGRmKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuXHQgICAgfTtcclxuXHR9LFxyXG5cclxuICAgICAgICBpbnN0ID0gbmV3IFBkZlByaW50ZXIoKTtcclxuICAgIFxyXG5cdHJldHVybiBpbnN0O1xyXG59XSk7IiwiLypnbG9iYWwgbmdQcmludCovXHJcblxyXG5cclxubmdQcmludC5kaXJlY3RpdmUoJ25nUHJpbnRCdXR0b24nLCBbJyR3aW5kb3cnLCAncGRmUHJpbnRlcicsIGZ1bmN0aW9uICgkd2luZG93LCBwZGZQcmludGVyKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBcclxuXHRyZXR1cm4ge1xyXG5cdFx0cmVzdHJpY3Q6ICdBQycsXHJcblx0XHRyZXF1aXJlOiAnXm5nUHJpbnRhYmxlJyxcclxuXHRcdHNjb3BlOiB7XHJcblx0XHRcdHByaW50V2hvbGVQYWdlOiAnJj8nLFxyXG4gICAgICAgICAgICBzYXZlQXM6ICdAPydcclxuXHRcdH0sXHJcblx0XHRsaW5rOiBmdW5jdGlvbiAoJHNjb3BlLCBlbGVtZW50LCBhdHRyLCBuZ1ByaW50YWJsZUNvbnRyb2xsZXIpIHtcclxuXHRcdFx0dmFyIGdldENvbmZpZ0F0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG5cdFx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0XHRvcmllbnRhdGlvbjogZWxlbWVudFswXS5hdHRyaWJ1dGVzWydvcmllbnRhdGlvbiddID8gZWxlbWVudFswXS5hdHRyaWJ1dGVzWydvcmllbnRhdGlvbiddLnZhbHVlIDogJ3AnLFxyXG5cdFx0XHRcdFx0dW5pdDogZWxlbWVudFswXS5hdHRyaWJ1dGVzWyd1bml0J10gPyBlbGVtZW50WzBdLmF0dHJpYnV0ZXNbJ3VuaXQnXS52YWx1ZSA6ICdwdCcsXHJcblx0XHRcdFx0XHRmb3JtYXQ6IGVsZW1lbnRbMF0uYXR0cmlidXRlc1snZm9ybWF0J10gPyBlbGVtZW50WzBdLmF0dHJpYnV0ZXNbJ2Zvcm1hdCddLnZhbHVlIDogJ2E0J1xyXG5cdFx0XHRcdH07XHJcblx0XHRcdH07XHJcblxyXG5cdFx0XHQkc2NvcGUucHJpbnQgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0dmFyIGVsZW1lbnQ7XHJcblxyXG5cdFx0XHRcdGlmICgkc2NvcGUucHJpbnRXaG9sZVBhZ2UoKSkge1xyXG5cdFx0XHRcdFx0ZWxlbWVudCA9ICR3aW5kb3cuZG9jdW1lbnQuYm9keTtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKG5nUHJpbnRhYmxlQ29udHJvbGxlcikge1xyXG5cdFx0XHRcdFx0ZWxlbWVudCA9IG5nUHJpbnRhYmxlQ29udHJvbGxlci5nZXRFbGVtZW50KCk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAoZWxlbWVudCkge1xyXG5cdFx0XHRcdFx0dmFyIGNvbmZpZyA9IGdldENvbmZpZ0F0dHJpYnV0ZXMoZWxlbWVudCk7XHJcblx0XHRcdFx0XHR2YXIgcHJvbWlzZSA9IHBkZlByaW50ZXIuZ2VuZXJhdGVQZGZGcm9tRWxlbWVudChlbGVtZW50LCBjb25maWcub3JpZW50YXRpb24sIGNvbmZpZy51bml0LCBjb25maWcuZm9ybWF0KTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHBkZikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZigkc2NvcGUuc2F2ZUFzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGYuc2F2ZSgkc2NvcGUuc2F2ZUFzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkZi5vdXRwdXQoJ2RhdGF1cmxuZXd3aW5kb3cnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcGRmID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dGhyb3cgbmV3IFN5bnRheEVycm9yKCdObyB0ZW1wbGF0ZSBlbGVtZW50IHByb3ZpZGVkLiBUcnkgdXNpbmcgbmdQcmludGFibGUgZGlyZWN0aXZlLicpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnByaW50KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cdFx0fVxyXG5cdH07XHJcbn1dKTsiLCIvKmdsb2JhbCBuZ1ByaW50Ki9cclxuXHJcbm5nUHJpbnQuZGlyZWN0aXZlKCduZ1ByaW50YWJsZScsIFtmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBcclxuXHRyZXR1cm4ge1xyXG5cdFx0cmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICBzY29wZToge1xyXG4gICAgICAgICAgICBvcmllbnRhdGlvbjogJ0A/JyxcclxuICAgICAgICAgICAgdW5pdDogJ0A/JyxcclxuICAgICAgICAgICAgZm9ybWF0OiAnQD8nXHJcbiAgICAgICAgfSxcclxuXHRcdGxpbms6IGZ1bmN0aW9uICgkc2NvcGUsIGVsZW1lbnQpIHtcclxuXHRcdFx0JHNjb3BlLmVsZW1lbnQgPSBlbGVtZW50O1xyXG5cdFx0fSxcclxuICAgICAgICBjb250cm9sbGVyOiBbJyRzY29wZScsIGZ1bmN0aW9uICgkc2NvcGUpIHtcclxuICAgICAgICAgICAgdGhpcy5nZXRFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRzY29wZS5lbGVtZW50O1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1dXHJcbiAgICB9O1xyXG59XSk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==